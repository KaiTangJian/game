
#ifndef __NRF24L01_H__
#define __NRF24L01_H__


//CE PC0
//CS PC1
//MISO PC2
//MOSI PC3
//IRQ PF10
//SCK PB10
/****************************************************************************************************/
/**********************************************************************************************************/
//NRF24L01å¯„å­˜å™¨æ“ä½œå‘½ä»?
#define SPI_READ_REG    0x00  //è¯»é…ç½®å¯„å­˜å™¨,ä½?5ä½ä¸ºå¯„å­˜å™¨åœ°å€
#define SPI_WRITE_REG   0x20  //å†™é…ç½®å¯„å­˜å™¨,ä½?5ä½ä¸ºå¯„å­˜å™¨åœ°å€
#define RD_RX_PLOAD     0x61  //è¯»RXæœ‰æ•ˆæ•°æ®,1~32å­—èŠ‚
#define WR_TX_PLOAD     0xA0  //å†™TXæœ‰æ•ˆæ•°æ®,1~32å­—èŠ‚
#define FLUSH_TX        0xE1  //æ¸…é™¤TX FIFOå¯„å­˜å™?.å‘å°„æ¨¡å¼ä¸‹ç”¨
#define FLUSH_RX        0xE2  //æ¸…é™¤RX FIFOå¯„å­˜å™?.æ¥æ”¶æ¨¡å¼ä¸‹ç”¨
#define REUSE_TX_PL     0xE3  //é‡æ–°ä½¿ç”¨ä¸Šä¸€åŒ…æ•°æ?,CEä¸ºé«˜,æ•°æ®åŒ…è¢«ä¸æ–­å‘é€?.
#define NOP             0xFF  //ç©ºæ“ä½?,å¯ä»¥ç”¨æ¥è¯»çŠ¶æ€å¯„å­˜å™¨	 

//SPI(NRF24L01)å¯„å­˜å™¨åœ°å€
#define CONFIG          0x00  //é…ç½®å¯„å­˜å™¨åœ°å€;bit0:1æ¥æ”¶æ¨¡å¼,0å‘å°„æ¨¡å¼;bit1:ç”µé€‰æ‹©;bit2:CRCæ¨¡å¼;bit3:CRCä½¿èƒ½;
                              //bit4:ä¸­æ–­MAX_RT(è¾¾åˆ°æœ€å¤§é‡å‘æ¬¡æ•°ä¸­æ–?)ä½¿èƒ½;bit5:ä¸­æ–­TX_DSä½¿èƒ½;bit6:ä¸­æ–­RX_DRä½¿èƒ½
#define EN_AA           0x01  //ä½¿èƒ½è‡ªåŠ¨åº”ç­”åŠŸèƒ½  bit0~5,å¯¹åº”é€šé“0~5
#define EN_RXADDR       0x02  //æ¥æ”¶åœ°å€å…è®¸,bit0~5,å¯¹åº”é€šé“0~5
#define SETUP_AW        0x03  //è®¾ç½®åœ°å€å®½åº¦(æ‰€æœ‰æ•°æ®é€šé“):bit1,0:00,3å­—èŠ‚;01,4å­—èŠ‚;02,5å­—èŠ‚;
#define SETUP_RETR      0x04  //å»ºç«‹è‡ªåŠ¨é‡å‘;bit3:0,è‡ªåŠ¨é‡å‘è®¡æ•°å™?;bit7:4,è‡ªåŠ¨é‡å‘å»¶æ—¶ 250*x+86us
#define RF_CH           0x05  //RFé€šé“,bit6:0,å·¥ä½œé€šé“é¢‘ç‡;
#define RF_SETUP        0x06  //RFå¯„å­˜å™?;bit3:ä¼ è¾“é€Ÿç‡(0:1Mbps,1:2Mbps);bit2:1,å‘å°„åŠŸç‡;bit0:ä½å™ªå£°æ”¾å¤§å™¨å¢ç›Š
#define STATUS          0x07  //çŠ¶æ€å¯„å­˜å™¨;bit0:TX FIFOæ»¡æ ‡å¿?;bit3:1,æ¥æ”¶æ•°æ®é€šé“å?(æœ€å¤?:6);
                              //bit4,è¾¾åˆ°æœ€å¤šæ¬¡é‡å‘;bit5:æ•°æ®å‘é€å®Œæˆä¸­æ–?;bit6:æ¥æ”¶æ•°æ®ä¸­æ–­;
#define MAX_TX  	    0x10  //è¾¾åˆ°æœ€å¤§å‘é€æ¬¡æ•°ä¸­æ–?
#define TX_OK       	0x20  //TXå‘é€å®Œæˆä¸­æ–?
#define RX_OK   	    0x40  //æ¥æ”¶åˆ°æ•°æ®ä¸­æ–?

#define OBSERVE_TX      0x08  //å‘é€æ£€æµ‹å¯„å­˜å™¨,bit7:4,æ•°æ®åŒ…ä¸¢å¤±è®¡æ•°å™¨;bit3:0,é‡å‘è®¡æ•°å™?
#define CD              0x09  //è½½æ³¢æ£€æµ‹å¯„å­˜å™¨,bit0,è½½æ³¢æ£€æµ?;
#define RX_ADDR_P0      0x0A  //æ•°æ®é€šé“0æ¥æ”¶åœ°å€,æœ€å¤§é•¿åº?5ä¸ªå­—èŠ?,ä½å­—èŠ‚åœ¨å‰?
#define RX_ADDR_P1      0x0B  //æ•°æ®é€šé“1æ¥æ”¶åœ°å€,æœ€å¤§é•¿åº?5ä¸ªå­—èŠ?,ä½å­—èŠ‚åœ¨å‰?
#define RX_ADDR_P2      0x0C  //æ•°æ®é€šé“2æ¥æ”¶åœ°å€,æœ€ä½å­—èŠ‚å¯è®¾ç½®,é«˜å­—èŠ?,å¿…é¡»åŒRX_ADDR_P1[39:8]ç›¸ç­‰;
#define RX_ADDR_P3      0x0D  //æ•°æ®é€šé“3æ¥æ”¶åœ°å€,æœ€ä½å­—èŠ‚å¯è®¾ç½®,é«˜å­—èŠ?,å¿…é¡»åŒRX_ADDR_P1[39:8]ç›¸ç­‰;
#define RX_ADDR_P4      0x0E  //æ•°æ®é€šé“4æ¥æ”¶åœ°å€,æœ€ä½å­—èŠ‚å¯è®¾ç½®,é«˜å­—èŠ?,å¿…é¡»åŒRX_ADDR_P1[39:8]ç›¸ç­‰;
#define RX_ADDR_P5      0x0F  //æ•°æ®é€šé“5æ¥æ”¶åœ°å€,æœ€ä½å­—èŠ‚å¯è®¾ç½®,é«˜å­—èŠ?,å¿…é¡»åŒRX_ADDR_P1[39:8]ç›¸ç­‰;
#define TX_ADDR         0x10  //å‘é€åœ°å€(ä½å­—èŠ‚åœ¨å‰?),ShockBurstTMæ¨¡å¼ä¸?,RX_ADDR_P0ä¸æ­¤åœ°å€ç›¸ç­‰
#define RX_PW_P0        0x11  //æ¥æ”¶æ•°æ®é€šé“0æœ‰æ•ˆæ•°æ®å®½åº¦(1~32å­—èŠ‚),è®¾ç½®ä¸?0åˆ™éæ³?
#define RX_PW_P1        0x12  //æ¥æ”¶æ•°æ®é€šé“1æœ‰æ•ˆæ•°æ®å®½åº¦(1~32å­—èŠ‚),è®¾ç½®ä¸?0åˆ™éæ³?
#define RX_PW_P2        0x13  //æ¥æ”¶æ•°æ®é€šé“2æœ‰æ•ˆæ•°æ®å®½åº¦(1~32å­—èŠ‚),è®¾ç½®ä¸?0åˆ™éæ³?
#define RX_PW_P3        0x14  //æ¥æ”¶æ•°æ®é€šé“3æœ‰æ•ˆæ•°æ®å®½åº¦(1~32å­—èŠ‚),è®¾ç½®ä¸?0åˆ™éæ³?
#define RX_PW_P4        0x15  //æ¥æ”¶æ•°æ®é€šé“4æœ‰æ•ˆæ•°æ®å®½åº¦(1~32å­—èŠ‚),è®¾ç½®ä¸?0åˆ™éæ³?
#define RX_PW_P5        0x16  //æ¥æ”¶æ•°æ®é€šé“5æœ‰æ•ˆæ•°æ®å®½åº¦(1~32å­—èŠ‚),è®¾ç½®ä¸?0åˆ™éæ³?
#define FIFO_STATUS     0x17  //FIFOçŠ¶æ€å¯„å­˜å™¨;bit0,RX FIFOå¯„å­˜å™¨ç©ºæ ‡å¿—;bit1,RX FIFOæ»¡æ ‡å¿?;bit2,3,ä¿ç•™
                              //bit4,TX FIFOç©ºæ ‡å¿?;bit5,TX FIFOæ»¡æ ‡å¿?;bit6,1,å¾ªç¯å‘é€ä¸Šä¸€æ•°æ®åŒ?.0,ä¸å¾ªç?;
/**********************************************************************************************************/
/**********************************************************************************************************/
//NRF24L01æ§åˆ¶æ“ä½œ

//NRF2401ç‰‡é€‰ä¿¡å?
#define Clr_NRF24L01_CE      HAL_GPIO_WritePin(GPIOC, GPIO_PIN_0,GPIO_PIN_RESET)
#define Set_NRF24L01_CE      HAL_GPIO_WritePin(GPIOC, GPIO_PIN_0,GPIO_PIN_SET)

//SPIç‰‡é€‰ä¿¡å?
#define Clr_NRF24L01_CSN     HAL_GPIO_WritePin(GPIOC, GPIO_PIN_1, GPIO_PIN_RESET)
#define Set_NRF24L01_CSN     HAL_GPIO_WritePin(GPIOC, GPIO_PIN_1, GPIO_PIN_SET)

//NRF2401_IRQæ•°æ®è¾“å…¥
#define READ_NRF24L01_IRQ   HAL_GPIO_ReadPin(GPIOF,GPIO_PIN_10)

//NRF24L01å‘é€æ¥æ”¶åœ°å€ã€å‘é€æ¥æ”¶æ•°æ®å®½åº¦å®šä¹?
#define TX_ADR_WIDTH    5                               //5å­—èŠ‚çš„åœ°å€å®½åº¦
#define RX_ADR_WIDTH    5                               //5å­—èŠ‚çš„åœ°å€å®½åº¦
#define TX_PLOAD_WIDTH  8                              //8èŠ‚çš„ç”¨æˆ·æ•°æ®å®½åº¦
#define RX_PLOAD_WIDTH  8                              //8å­—èŠ‚çš„ç”¨æˆ·æ•°æ®å®½åº?

/**********************************************************************************************************/
/**********************************************************************************************************/
//å‡½æ•°å£°æ˜
void NRF24L01_Init(void);                                //NRF24l01åˆå§‹åŒ?
void RX_Mode(unsigned char numofslave);   //é…ç½®ä¸ºæ¥æ”¶æ¨¡å¼?
void TX_Mode(unsigned char numofslave);  //é…ç½®ä¸ºå‘é€æ¨¡å¼?
unsigned char NRF24L01_Write_Buf(unsigned char regaddr, unsigned char *pBuf, unsigned char datalen); //å†™æ•°æ®åŒº
unsigned char NRF24L01_Read_Buf(unsigned char regaddr, unsigned char *pBuf, unsigned char datalen);  //è¯»æ•°æ®åŒº
unsigned char NRF24L01_Read_Reg(unsigned char regaddr);		                 //è¯»å¯„å­˜å™¨
unsigned char NRF24L01_Write_Reg(unsigned char regaddr, unsigned char data);              //å†™å¯„å­˜å™¨
unsigned char NRF24L01_Check(void);                                 //æ£€æŸ¥NRF24L01æ˜¯å¦åœ¨ä½
unsigned char NRF24L01_TxPacket(unsigned char *txbuf);                         //å‘é€ä¸€ä¸ªåŒ…çš„æ•°æ?
unsigned char NRF24L01_RxPacket(unsigned char *rxbuf);                         //æ¥æ”¶ä¸€ä¸ªåŒ…çš„æ•°æ?
/**********************************************************************************************************/

#endif

